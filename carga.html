<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     
    <!-- Favicon -->
     
    <!-- Navegador Cásico -->
    <link rel="icon" href="./static/imagenes/favicon.ico">
    <!-- Navegaor mood dark -->
     <link rel="stylesheet" href="./static/imagenes/favicon-32x32.png">
    <!-- Dispositvo Apple -->
    <link rel="icon" href="./static/imagenes/apple-touch-icon.png">
    <!-- Dsipositivo Android 192x192 -->
    <link rel="icon" href="./static/imagenes/android-chrome-192x192.png">
    <!-- Dispositivo Android 512x512 -->
    <link rel="icon" href="./static/imagenes/android-chrome-512x512.png">


    <title>Carga</title>
    
    <link rel="stylesheet" href="./static/traductor.css">

</head>
<body>
    
 <header>
        <nav class="navbar-index ">
            <img class="logo-nav" src="./static/imagenes/logo_llamada_3.png" alt="logo language traduction">
        </nav>
    </header>

    <div class="logo-centrado">
        <img src="./static/imagenes/logo_cuadrado6.png" alt="logo">
    </div>
    <h1>Agregar Palabra a la Lista</h1><br>

    <!--enctype="multipart/form-data" es necesario para enviar archivos al back.-->
    <form id="formulario" enctype="multipart/form-data">
        
        <label for="categoria">Categoria:</label>
        <input type="text" id="categoria" name="categoria" required><br>

        <label for="español">Español:</label>
        <input type="text" id="español" name="español" required><br>

        <label for="ingles">Ingles:</label>
        <input type="text" id="ingles" name="ingles" required><br>

        <label for="frances">Frances:</label>
        <input type="text" id="frances" name="frances" required><br>

        <label for="aleman">Aleman:</label>
        <input type="text" id="aleman" name="aleman" required><br>

        <label for="imagenPalabra">Imagen de la palabra:</label>
        <input type="file" id="imagenPalabra" name="imagen">

        
        
        <button type="submit">Agregar Palabra</button>
        <a href="index.html">Menu principal</a>
    </form>

    <script>
        const URL = "http://127.0.0.1:5000/"

        //Al subir al servidor, deberá utilizarse la siguiente ruta. USUARIO debe ser reemplazado por el nombre de usuario de Pythonanywhere
        //const URL = "https://USUARIO.pythonanywhere.com/"
        

        // Capturamos el evento de envío del formulario
        document.getElementById('formulario').addEventListener('submit', function (event) {
            event.preventDefault(); // Evitamos que se envie el form 

            var formData = new FormData(this);
    
            // Realizamos la solicitud POST al servidor
            fetch(URL + 'language', {
                method: 'POST',
                body: formData // Aquí enviamos formData. Dado que formData puede contener archivos, no se utiliza JSON.
            })

            //Después de realizar la solicitud POST, se utiliza el método then() para manejar la respuesta del servidor.
            .then(function (response) {
                    if (response.ok) { 
                        //Si la respuesta es exitosa, convierte los datos de la respuesta a formato JSON.
                        return response.json(); 
                    } else {
                        // Si hubo un error, lanzar explícitamente una excepción
                        // para ser "catcheada" más adelante
                        throw new Error('Error al agregar la palabra.');
                    }
            })

                //Respuesta OK, muestra una alerta informando que el producto se agregó correctamente y limpia los campos del formulario para que puedan ser utilizados para un nuevo producto.
                .then(function (data) {
                    alert('Palabra agregada correctamente.');
                })

                // En caso de error, mostramos una alerta con un mensaje de error.
                .catch(function (error) {
                    alert('Error al agregar la palabra.');
                })

                // Limpiar el formulario en ambos casos (éxito o error)
                .finally(function () {
                    document.getElementById('categoria').value = "";
                    document.getElementById('español').value = "";
                    document.getElementById('ingles').value = "";
                    document.getElementById('frances').value = "";
                    document.getElementById('aleman').value = "";
                    document.getElementById('imagenPalabra').value = "";
                    
                });
        })
    </script>



</body>
</html>